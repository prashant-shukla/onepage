<section class="video-section color-{{ section.settings.color_scheme }} gradient">
  <div class="video-section__container">
    {%- if section.settings.heading != blank -%}
      <div class="video-section__header">
        <h2 class="video-section__title">{{ section.settings.heading }}</h2>
        {%- if section.settings.subheading != blank -%}
          <p class="video-section__subtitle">{{ section.settings.subheading }}</p>
        {%- endif -%}
      </div>
    {%- endif -%}

    <div class="video-section__content">
      {%- if section.settings.video_url != blank -%}
        <div class="video-section__video-wrapper">
          {%- liquid
            assign video_id = ''
            assign video_type = ''
            
            if section.settings.video_url contains 'youtube.com/watch'
              assign video_id = section.settings.video_url | split: 'v=' | last | split: '&' | first
              assign video_type = 'youtube'
            elsif section.settings.video_url contains 'youtu.be/'
              assign video_id = section.settings.video_url | split: 'youtu.be/' | last | split: '?' | first
              assign video_type = 'youtube'
            elsif section.settings.video_url contains 'vimeo.com/'
              assign video_id = section.settings.video_url | split: 'vimeo.com/' | last | split: '?' | first
              assign video_type = 'vimeo'
            endif
          -%}

          {%- if video_type == 'youtube' -%}
            <iframe
              src="https://www.youtube.com/embed/{{ video_id }}?rel=0&showinfo=0&autohide=1"
              class="video-section__video"
              frameborder="0"
              allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
              allowfullscreen
              loading="lazy"
            ></iframe>
          {%- elsif video_type == 'vimeo' -%}
            <iframe
              src="https://player.vimeo.com/video/{{ video_id }}?title=0&byline=0&portrait=0"
              class="video-section__video"
              frameborder="0"
              allow="autoplay; fullscreen; picture-in-picture"
              allowfullscreen
              loading="lazy"
            ></iframe>
          {%- else -%}
            <div class="video-section__error">
              <p>Please provide a valid YouTube or Vimeo URL</p>
            </div>
          {%- endif -%}
        </div>
      {%- else -%}
        <div class="video-section__placeholder">
          <div class="video-section__placeholder-content">
            <svg width="80" height="80" viewBox="0 0 80 80" fill="none" xmlns="http://www.w3.org/2000/svg">
              <circle cx="40" cy="40" r="40" fill="#f3f3f3"/>
              <path d="M32 25L55 40L32 55V25Z" fill="#999"/>
            </svg>
            <p>Add a video URL to display your product in action</p>
          </div>
        </div>
      {%- endif -%}

      {%- if section.settings.description != blank -%}
        <div class="video-section__description">
          {{ section.settings.description }}
        </div>
      {%- endif -%}
    </div>
  </div>
</section>

<style>
  .video-section {
    padding: 6rem 0;
    background: var(--color-base-background-2);
  }

  .video-section__container {
    max-width: 1000px;
    margin: 0 auto;
    padding: 0 2rem;
  }

  .video-section__header {
    text-align: center;
    margin-bottom: 3rem;
  }

  .video-section__title {
    font-size: 3rem;
    font-weight: 700;
    margin-bottom: 1rem;
    color: var(--color-base-text);
  }

  .video-section__subtitle {
    font-size: 1.2rem;
    color: #666;
    max-width: 600px;
    margin: 0 auto;
  }

  .video-section__content {
    position: relative;
  }

  .video-section__video-wrapper {
    position: relative;
    width: 100%;
    height: 0;
    padding-bottom: 56.25%; /* 16:9 aspect ratio */
    border-radius: 1rem;
    overflow: hidden;
    box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
  }

  .video-section__video {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    border: none;
  }

  .video-section__placeholder {
    width: 100%;
    height: 400px;
    background: #f8f9fa;
    border-radius: 1rem;
    display: flex;
    align-items: center;
    justify-content: center;
    border: 2px dashed #ddd;
  }

  .video-section__placeholder-content {
    text-align: center;
    color: #999;
  }

  .video-section__placeholder-content p {
    margin-top: 1rem;
    font-size: 1.1rem;
  }

  .video-section__error {
    width: 100%;
    height: 400px;
    background: #f8f9fa;
    border-radius: 1rem;
    display: flex;
    align-items: center;
    justify-content: center;
    color: #e74c3c;
    font-size: 1.1rem;
  }

  .video-section__description {
    margin-top: 2rem;
    text-align: center;
    font-size: 1.1rem;
    line-height: 1.6;
    color: #666;
    max-width: 600px;
    margin-left: auto;
    margin-right: auto;
  }

  @media (max-width: 768px) {
    .video-section__title {
      font-size: 2.5rem;
    }

    .video-section__placeholder,
    .video-section__error {
      height: 250px;
    }
  }
</style>

{% schema %}
{
  "name": "Video Section",
  "tag": "section",
  "class": "section",
  "settings": [
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "See It In Action"
    },
    {
      "type": "text",
      "id": "subheading",
      "label": "Subheading",
      "default": "Watch our product demonstration video"
    },
    {
      "type": "url",
      "id": "video_url",
      "label": "Video URL",
      "info": "Enter a YouTube or Vimeo URL"
    },
    {
      "type": "richtext",
      "id": "description",
      "label": "Description",
      "default": "<p>This video shows how our product works and the benefits it provides to our customers.</p>"
    },
    {
      "type": "color_scheme",
      "id": "color_scheme",
      "label": "Color scheme",
      "default": "background-1"
    }
  ],
  "presets": [
    {
      "name": "Video Section"
    }
  ]
}
{% endschema %}
