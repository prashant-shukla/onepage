<div class="product-detail">
  <div class="product-detail__container">
    <div class="product-detail__grid">
      <div class="product-detail__images">
        <div class="product-detail__main-image">
          {%- if product.featured_media -%}
            <img 
              src="{{ product.featured_media | image_url: width: 600 }}" 
              alt="{{ product.featured_media.alt | default: product.title }}"
              class="product-detail__image"
              id="ProductImage"
              width="600"
              height="600"
            >
          {%- else -%}
            <div class="product-detail__placeholder">
              <svg width="400" height="400" viewBox="0 0 400 400" fill="none" xmlns="http://www.w3.org/2000/svg">
                <rect width="400" height="400" fill="#f3f3f3"/>
                <path d="M100 100H300V300H100V100Z" stroke="#ccc" stroke-width="2" fill="none"/>
              </svg>
            </div>
          {%- endif -%}
        </div>

        {%- if product.media.size > 1 -%}
          <div class="product-detail__thumbnails">
            {%- for media in product.media limit: 4 -%}
              <button 
                class="product-detail__thumbnail{% if forloop.first %} product-detail__thumbnail--active{% endif %}"
                data-media-id="{{ media.id }}"
              >
                {{ media | image_url: width: 100 | image_tag: 
                  alt: media.alt | default: product.title,
                  class: 'product-detail__thumbnail-image',
                  width: 100,
                  height: 100
                }}
              </button>
            {%- endfor -%}
          </div>
        {%- endif -%}
      </div>

      <div class="product-detail__info">
        <div class="product-detail__breadcrumb">
          <a href="{{ routes.root_url }}">Home</a> / 
          <a href="{{ routes.all_products_collection_url }}">Products</a> / 
          <span>{{ product.title }}</span>
        </div>

        <h1 class="product-detail__title">{{ product.title }}</h1>
        
        <div class="product-detail__price">
          {%- if product.compare_at_price > product.price -%}
            <span class="price price--compare">{{ product.compare_at_price | money }}</span>
            <span class="price price--sale">{{ product.price | money }}</span>
            <span class="product-detail__sale-badge">Save {{ product.compare_at_price | minus: product.price | money }}</span>
          {%- else -%}
            <span class="price">{{ product.price | money }}</span>
          {%- endif -%}
        </div>

        {%- if product.description != blank -%}
          <div class="product-detail__description">
            {{ product.description }}
          </div>
        {%- endif -%}

        <form action="{{ routes.cart_add_url }}" method="post" enctype="multipart/form-data" class="product-detail__form">
          <input type="hidden" name="id" value="{{ product.selected_or_first_available_variant.id }}">
          
          {%- unless product.has_only_default_variant -%}
            <div class="product-detail__variants">
              {%- for option in product.options_with_values -%}
                <div class="product-detail__option">
                  <label for="Option-{{ forloop.index0 }}" class="product-detail__option-label">
                    {{ option.name }}
                  </label>
                  <select 
                    id="Option-{{ forloop.index0 }}" 
                    name="options[{{ option.name | escape }}]"
                    class="product-detail__option-select"
                  >
                    {%- for value in option.values -%}
                      <option value="{{ value | escape }}"{% if option.selected_value == value %} selected{% endif %}>
                        {{ value }}
                      </option>
                    {%- endfor -%}
                  </select>
                </div>
              {%- endfor -%}
            </div>
          {%- endunless -%}

          <div class="product-detail__quantity">
            <label for="Quantity" class="product-detail__quantity-label">Quantity</label>
            <div class="product-detail__quantity-controls">
              <button type="button" class="product-detail__quantity-btn" data-action="decrease">-</button>
              <input 
                type="number" 
                id="Quantity" 
                name="quantity" 
                value="1" 
                min="1" 
                class="product-detail__quantity-input"
              >
              <button type="button" class="product-detail__quantity-btn" data-action="increase">+</button>
            </div>
          </div>

          <div class="product-detail__actions">
            <button 
              type="submit" 
              name="add" 
              class="button button--primary button--large product-detail__add-to-cart"
              {% unless product.available %}disabled{% endunless %}
            >
              {%- if product.available -%}
                <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg" style="margin-right: 0.5rem;">
                  <path d="M3 3H5L5.4 5M7 13H17L21 5H5.4M7 13L5.4 5M7 13L4.7 15.3C4.3 15.7 4.6 16.5 5.1 16.5H17M17 13V17C17 17.6 16.6 18 16 18H8C7.4 18 7 17.6 7 17V13" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
                Add to Cart
              {%- else -%}
                Sold Out
              {%- endif -%}
            </button>
          </div>
        </form>

        <div class="product-detail__features">
          <div class="product-detail__feature">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M9 12L11 14L15 10M21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3C16.9706 3 21 7.02944 21 12Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
            <span>Premium Quality</span>
          </div>
          <div class="product-detail__feature">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M12 2L15.09 8.26L22 9L17 14L18.18 21L12 17.77L5.82 21L7 14L2 9L8.91 8.26L12 2Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
            <span>Free Shipping</span>
          </div>
          <div class="product-detail__feature">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              <path d="M8 12L10.5 14.5L16 9" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
            <span>30-Day Returns</span>
          </div>
        </div>

        <div class="product-detail__meta">
          <div class="product-detail__meta-item">
            <span class="product-detail__meta-label">SKU:</span>
            <span class="product-detail__meta-value">{{ product.selected_or_first_available_variant.sku | default: 'N/A' }}</span>
          </div>
          
          <div class="product-detail__meta-item">
            <span class="product-detail__meta-label">Vendor:</span>
            <span class="product-detail__meta-value">{{ product.vendor }}</span>
          </div>

          {%- if product.tags.size > 0 -%}
            <div class="product-detail__meta-item">
              <span class="product-detail__meta-label">Tags:</span>
              <div class="product-detail__tag-list">
                {%- for tag in product.tags -%}
                  <span class="product-detail__tag">{{ tag }}</span>
                {%- endfor -%}
              </div>
            </div>
          {%- endif -%}
        </div>
      </div>
    </div>

    {%- if product.metafields.custom.product_features != blank -%}
      <div class="product-detail__features-section">
        <h2>Product Features</h2>
        <div class="product-detail__features-content">
          {{ product.metafields.custom.product_features }}
        </div>
      </div>
    {%- endif -%}
  </div>
</div>

<style>
  .product-detail {
    padding: 2rem 0;
    min-height: 60vh;
    background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
  }

  .product-detail__container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 0 2rem;
  }

  .product-detail__grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 4rem;
    margin-bottom: 4rem;
  }

  .product-detail__images {
    display: flex;
    flex-direction: column;
    gap: 1rem;
  }

  .product-detail__main-image {
    position: relative;
    overflow: hidden;
    border-radius: 2rem;
    box-shadow: 0 20px 40px rgba(0,0,0,0.1);
    background: white;
  }

  .product-detail__image {
    width: 100%;
    height: 500px;
    object-fit: cover;
    transition: transform 0.3s ease;
  }

  .product-detail__placeholder {
    width: 100%;
    height: 500px;
    background: #f8f9fa;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .product-detail__thumbnails {
    display: flex;
    gap: 1rem;
    overflow-x: auto;
    padding: 0.5rem 0;
  }

  .product-detail__thumbnail {
    flex-shrink: 0;
    width: 80px;
    height: 80px;
    border: 3px solid transparent;
    border-radius: 1rem;
    overflow: hidden;
    cursor: pointer;
    transition: all 0.3s ease;
    background: white;
    box-shadow: 0 4px 8px rgba(0,0,0,0.1);
  }

  .product-detail__thumbnail--active {
    border-color: #007bff;
    transform: scale(1.05);
  }

  .product-detail__thumbnail-image {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  .product-detail__info {
    display: flex;
    flex-direction: column;
    gap: 2rem;
    background: white;
    padding: 3rem;
    border-radius: 2rem;
    box-shadow: 0 20px 40px rgba(0,0,0,0.1);
  }

  .product-detail__breadcrumb {
    font-size: 1.2rem;
    color: #6c757d;
    margin-bottom: 1rem;
  }

  .product-detail__breadcrumb a {
    color: #007bff;
    text-decoration: none;
  }

  .product-detail__breadcrumb a:hover {
    text-decoration: underline;
  }

  .product-detail__title {
    font-size: 3rem;
    font-weight: 800;
    color: #2c3e50;
    margin: 0;
    line-height: 1.2;
  }

  .product-detail__price {
    display: flex;
    align-items: center;
    gap: 1rem;
    flex-wrap: wrap;
  }

  .price {
    font-size: 2.5rem;
    font-weight: 800;
    color: #2c3e50;
  }

  .price--compare {
    text-decoration: line-through;
    color: #6c757d;
    font-size: 2rem;
  }

  .price--sale {
    color: #dc3545;
  }

  .product-detail__sale-badge {
    background: linear-gradient(135deg, #dc3545 0%, #c82333 100%);
    color: white;
    padding: 0.5rem 1rem;
    border-radius: 2rem;
    font-size: 1.2rem;
    font-weight: 700;
    box-shadow: 0 4px 15px rgba(220,53,69,0.3);
  }

  .product-detail__description {
    font-size: 1.4rem;
    line-height: 1.7;
    color: #6c757d;
  }

  .product-detail__form {
    display: flex;
    flex-direction: column;
    gap: 2rem;
  }

  .product-detail__variants {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
  }

  .product-detail__option {
    display: flex;
    flex-direction: column;
    gap: 0.8rem;
  }

  .product-detail__option-label {
    font-size: 1.4rem;
    font-weight: 700;
    color: #2c3e50;
  }

  .product-detail__option-select {
    padding: 1rem 1.2rem;
    border: 2px solid #e5e5e5;
    border-radius: 1rem;
    font-size: 1.4rem;
    background: white;
    transition: all 0.3s ease;
  }

  .product-detail__option-select:focus {
    border-color: #007bff;
    outline: none;
    box-shadow: 0 0 0 3px rgba(0,123,255,0.1);
  }

  .product-detail__quantity {
    display: flex;
    flex-direction: column;
    gap: 0.8rem;
  }

  .product-detail__quantity-label {
    font-size: 1.4rem;
    font-weight: 700;
    color: #2c3e50;
  }

  .product-detail__quantity-controls {
    display: flex;
    align-items: center;
    border: 2px solid #e5e5e5;
    border-radius: 1rem;
    overflow: hidden;
    width: fit-content;
    background: white;
  }

  .product-detail__quantity-btn {
    width: 50px;
    height: 50px;
    border: none;
    background: #f8f9fa;
    color: #6c757d;
    cursor: pointer;
    font-size: 1.6rem;
    font-weight: 700;
    transition: all 0.3s ease;
  }

  .product-detail__quantity-btn:hover {
    background: #007bff;
    color: white;
  }

  .product-detail__quantity-input {
    width: 100px;
    height: 50px;
    border: none;
    text-align: center;
    font-size: 1.6rem;
    font-weight: 700;
    background: white;
  }

  .product-detail__quantity-input:focus {
    outline: none;
  }

  .product-detail__actions {
    margin-top: 1rem;
  }

  .product-detail__add-to-cart {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 100%;
    padding: 1.5rem 2rem;
    font-size: 1.6rem;
    font-weight: 700;
    background: linear-gradient(135deg, #007bff 0%, #0056b3 100%);
    color: white;
    border: none;
    border-radius: 1rem;
    cursor: pointer;
    transition: all 0.3s ease;
    box-shadow: 0 4px 15px rgba(0,123,255,0.3);
  }

  .product-detail__add-to-cart:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 20px rgba(0,123,255,0.4);
  }

  .product-detail__add-to-cart:disabled {
    background: #6c757d;
    cursor: not-allowed;
    transform: none;
    box-shadow: none;
  }

  .product-detail__features {
    display: flex;
    gap: 2rem;
    flex-wrap: wrap;
    padding: 2rem;
    background: #f8f9fa;
    border-radius: 1rem;
  }

  .product-detail__feature {
    display: flex;
    align-items: center;
    gap: 0.8rem;
    color: #28a745;
    font-weight: 600;
  }

  .product-detail__meta {
    display: flex;
    flex-direction: column;
    gap: 1rem;
    padding-top: 2rem;
    border-top: 2px solid #e5e5e5;
  }

  .product-detail__meta-item {
    display: flex;
    gap: 1rem;
    align-items: center;
  }

  .product-detail__meta-label {
    font-weight: 700;
    color: #6c757d;
    min-width: 80px;
  }

  .product-detail__meta-value {
    color: #2c3e50;
  }

  .product-detail__tag-list {
    display: flex;
    flex-wrap: wrap;
    gap: 0.5rem;
  }

  .product-detail__tag {
    background: #e9ecef;
    color: #6c757d;
    padding: 0.4rem 0.8rem;
    border-radius: 1rem;
    font-size: 1.2rem;
    font-weight: 600;
  }

  .product-detail__features-section {
    background: white;
    padding: 3rem;
    border-radius: 2rem;
    box-shadow: 0 20px 40px rgba(0,0,0,0.1);
    margin-top: 2rem;
  }

  .product-detail__features-section h2 {
    font-size: 2.4rem;
    color: #2c3e50;
    margin-bottom: 2rem;
  }

  .product-detail__features-content {
    font-size: 1.4rem;
    line-height: 1.7;
    color: #6c757d;
  }

  @media (max-width: 768px) {
    .product-detail__grid {
      grid-template-columns: 1fr;
      gap: 2rem;
    }

    .product-detail__title {
      font-size: 2.4rem;
    }

    .product-detail__image {
      height: 300px;
    }

    .product-detail__placeholder {
      height: 300px;
    }

    .product-detail__thumbnails {
      justify-content: center;
    }

    .product-detail__features {
      flex-direction: column;
      gap: 1rem;
    }
  }
</style>

<script>
  // Thumbnail image switching
  document.addEventListener('DOMContentLoaded', function() {
    const thumbnails = document.querySelectorAll('.product-detail__thumbnail');
    const mainImage = document.getElementById('ProductImage');
    
    thumbnails.forEach(thumbnail => {
      thumbnail.addEventListener('click', function() {
        // Remove active class from all thumbnails
        thumbnails.forEach(t => t.classList.remove('product-detail__thumbnail--active'));
        // Add active class to clicked thumbnail
        this.classList.add('product-detail__thumbnail--active');
        
        // Update main image
        const thumbnailImg = this.querySelector('.product-detail__thumbnail-image');
        if (thumbnailImg && mainImage) {
          mainImage.src = thumbnailImg.src.replace('_100x100', '_600x600');
        }
      });
    });

    // Quantity controls
    const quantityInput = document.querySelector('.product-detail__quantity-input');
    const decreaseBtn = document.querySelector('[data-action="decrease"]');
    const increaseBtn = document.querySelector('[data-action="increase"]');
    
    if (decreaseBtn && quantityInput) {
      decreaseBtn.addEventListener('click', function() {
        const currentValue = parseInt(quantityInput.value);
        if (currentValue > 1) {
          quantityInput.value = currentValue - 1;
        }
      });
    }
    
    if (increaseBtn && quantityInput) {
      increaseBtn.addEventListener('click', function() {
        const currentValue = parseInt(quantityInput.value);
        quantityInput.value = currentValue + 1;
      });
    }
  });
</script>

{% schema %}
{
  "name": "Product Detail",
  "tag": "section",
  "class": "section",
  "settings": []
}
{% endschema %}
